(window.webpackJsonp=window.webpackJsonp||[]).push([[530],{1559:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i(51),o=i.n(a),s=i(3),c=i.n(s),l=i(2),r=i(7),d=i(22),h=i(28),p=i(8),u=i.n(p),g=i(126),f=i(5),b=i(9),m=i(45),O=i(899),j=i(616),v=i(58),_=i(71),M=i(1039),w=i(1212),C=i(27),N=i(1487),P=i(1693),x=i(1429),k=i(34),y=i(18);const I=Object(r.d)({btnAll:{id:"notification_purge.btn_all",defaultMessage:"Select all"},btnNone:{id:"notification_purge.btn_none",defaultMessage:"Select none"},btnInvert:{id:"notification_purge.btn_invert",defaultMessage:"Invert selection"},btnApply:{id:"notification_purge.btn_apply",defaultMessage:"Clear selected"}});class D extends y.a{render(){const{intl:t,markNewForDelete:e}=this.props;return Object(n.a)("div",{className:"column-header__notif-cleaning-buttons"},void 0,Object(n.a)("button",{onClick:this.props.onMarkAll,className:u()("column-header__button",{active:e})},void 0,Object(n.a)("b",{},void 0,"∀"),Object(n.a)("br",{}),t.formatMessage(I.btnAll)),Object(n.a)("button",{onClick:this.props.onMarkNone,className:u()("column-header__button",{active:!e})},void 0,Object(n.a)("b",{},void 0,"∅"),Object(n.a)("br",{}),t.formatMessage(I.btnNone)),Object(n.a)("button",{onClick:this.props.onInvert,className:"column-header__button"},void 0,Object(n.a)("b",{},void 0,"¬"),Object(n.a)("br",{}),t.formatMessage(I.btnInvert)),Object(n.a)("button",{onClick:this.props.onDeleteMarked,className:"column-header__button"},void 0,Object(n.a)(C.a,{id:"trash"}),Object(n.a)("br",{}),t.formatMessage(I.btnApply)))}}D.propTypes={onDeleteMarked:c.a.func.isRequired,onMarkAll:c.a.func.isRequired,onMarkNone:c.a.func.isRequired,onInvert:c.a.func.isRequired,intl:c.a.object.isRequired,markNewForDelete:c.a.bool};var q=Object(h.c)(D);const U=Object(r.d)({clearMessage:{id:"notifications.marked_clear_confirmation",defaultMessage:"Are you sure you want to permanently clear all selected notifications?"},clearConfirm:{id:"notifications.marked_clear",defaultMessage:"Clear selected notifications"}});var S=Object(h.c)(Object(b.connect)((t=>({markNewForDelete:t.getIn(["notifications","markNewForDelete"])})),((t,e)=>{let{intl:i}=e;return{onEnterCleaningMode(e){t(Object(v.w)(e))},onDeleteMarked(){t(Object(k.b)({modalType:"CONFIRM",modalProps:{message:i.formatMessage(U.clearMessage),confirm:i.formatMessage(U.clearConfirm),onConfirm:()=>t(Object(v.v)())}}))},onMarkAll(){t(Object(v.z)(!0))},onMarkNone(){t(Object(v.z)(!1))},onInvert(){t(Object(v.z)(null))}}}))(q)),R=i(110),T=i(66),W=i(33);const A=Object(r.d)({close:{id:"lightbox.close",defaultMessage:"Close"}});class F extends l.PureComponent{constructor(){super(...arguments),this.handleClick=()=>{this.props.dispatch(Object(v.E)())},this.handleClose=()=>{this.props.dispatch(Object(R.c)(["notifications","dismissPermissionBanner"],!0))}}render(){const{intl:t}=this.props;return Object(n.a)("div",{className:"notifications-permission-banner"},void 0,Object(n.a)("div",{className:"notifications-permission-banner__close"},void 0,Object(n.a)(W.a,{icon:"times",onClick:this.handleClose,title:t.formatMessage(A.close)})),Object(n.a)("h2",{},void 0,Object(n.a)(d.a,{id:"notifications_permission_banner.title",defaultMessage:"Never miss a thing"})),Object(n.a)("p",{},void 0,Object(n.a)(d.a,{id:"notifications_permission_banner.how_to_control",defaultMessage:"To receive notifications when Mastodon isn't open, enable desktop notifications. You can control precisely which types of interactions generate desktop notifications through the {icon} button above once they're enabled.",values:{icon:Object(n.a)(C.a,{id:"sliders"})}})),Object(n.a)(T.a,{onClick:this.handleClick},void 0,Object(n.a)(d.a,{id:"notifications_permission_banner.enable",defaultMessage:"Enable desktop notifications"})))}}var H=Object(b.connect)()(Object(h.c)(F)),L=i(119),B=i(778),E=i(150);class z extends l.Component{render(){return Object(n.a)("button",{className:"text-btn column-header__setting-btn",tabIndex:0,onClick:this.props.onClick},void 0,Object(n.a)(C.a,{id:"eraser"})," ",Object(n.a)(d.a,{id:"notifications.clear",defaultMessage:"Clear notifications"}))}}class $ extends l.PureComponent{render(){return Object(n.a)("button",{className:"text-btn column-header__permission-btn",tabIndex:0,onClick:this.props.onClick},void 0,Object(n.a)(d.a,{id:"notifications.grant_permission",defaultMessage:"Grant permission."}))}}class G extends l.PureComponent{constructor(){super(...arguments),this.onChange=()=>{const{settings:t,settingPath:e}=this.props;this.props.onChange(e,!t.getIn(e))}}render(){const{prefix:t,settings:e,settingPath:i,label:a,disabled:o}=this.props,s=["setting-pillbar-button",t,...i].filter(Boolean).join("-"),c=e.getIn(i);return Object(n.a)("button",{id:s,className:u()("pillbar-button",{active:c}),disabled:o,onClick:this.onChange,"aria-pressed":c},s,a)}}var K=i(1661);class J extends l.PureComponent{constructor(){super(...arguments),this.onPushChange=(t,e)=>{this.props.onChange(["push",...t],e)}}render(){const{settings:t,pushSettings:e,onChange:i,onClear:a,alertsEnabled:o,browserSupport:s,browserPermission:c,onRequestNotificationPermission:l}=this.props,r=Object(n.a)(d.a,{id:"notifications.column_settings.unread_notifications.highlight",defaultMessage:"Highlight unread notifications"}),h=Object(n.a)(d.a,{id:"notifications.column_settings.filter_bar.show_bar",defaultMessage:"Show filter bar"}),p=Object(n.a)(d.a,{id:"notifications.column_settings.filter_bar.advanced",defaultMessage:"Display all categories"}),u=Object(n.a)(d.a,{id:"notifications.column_settings.alert",defaultMessage:"Desktop notifications"}),g=Object(n.a)(d.a,{id:"notifications.column_settings.show",defaultMessage:"Show in column"}),f=Object(n.a)(d.a,{id:"notifications.column_settings.sound",defaultMessage:"Play sound"}),b=e.get("browserSupport")&&e.get("isSubscribed"),m=b&&Object(n.a)(d.a,{id:"notifications.column_settings.push",defaultMessage:"Push notifications"});return Object(n.a)("div",{},void 0,o&&s&&"denied"===c&&Object(n.a)("div",{className:"column-settings__row column-settings__row--with-margin"},void 0,Object(n.a)("span",{className:"warning-hint"},void 0,Object(n.a)(d.a,{id:"notifications.permission_denied",defaultMessage:"Desktop notifications are unavailable due to previously denied browser permissions request"}))),o&&s&&"default"===c&&Object(n.a)("div",{className:"column-settings__row column-settings__row--with-margin"},void 0,Object(n.a)("span",{className:"warning-hint"},void 0,Object(n.a)(d.a,{id:"notifications.permission_required",defaultMessage:"Desktop notifications are unavailable because the required permission has not been granted."})," ",Object(n.a)($,{onClick:l}))),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(z,{onClick:a})),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-unread-markers"},void 0,Object(n.a)("span",{id:"notifications-unread-markers",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.unread_notifications.category",defaultMessage:"Unread notifications"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(K.a,{id:"unread-notification-markers",prefix:"notifications",settings:t,settingPath:["showUnread"],onChange:i,label:r}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-filter-bar"},void 0,Object(n.a)("span",{id:"notifications-filter-bar",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.filter_bar.category",defaultMessage:"Quick filter bar"})),Object(n.a)("div",{className:"column-settings__row"},void 0,Object(n.a)(K.a,{id:"show-filter-bar",prefix:"notifications",settings:t,settingPath:["quickFilter","show"],onChange:i,label:h}),Object(n.a)(K.a,{id:"show-filter-bar",prefix:"notifications",settings:t,settingPath:["quickFilter","advanced"],onChange:i,label:p}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-follow"},void 0,Object(n.a)("span",{id:"notifications-follow",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.follow",defaultMessage:"New followers:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","follow"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","follow"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","follow"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","follow"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-follow-request"},void 0,Object(n.a)("span",{id:"notifications-follow-request",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.follow_request",defaultMessage:"New follow requests:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","follow_request"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","follow_request"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","follow_request"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","follow_request"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-favourite"},void 0,Object(n.a)("span",{id:"notifications-favourite",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.favourite",defaultMessage:"Favorites:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","favourite"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","favourite"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","favourite"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","favourite"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-mention"},void 0,Object(n.a)("span",{id:"notifications-mention",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.mention",defaultMessage:"Mentions:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","mention"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","mention"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","mention"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","mention"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-reblog"},void 0,Object(n.a)("span",{id:"notifications-reblog",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.reblog",defaultMessage:"Boosts:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","reblog"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","reblog"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","reblog"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","reblog"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-poll"},void 0,Object(n.a)("span",{id:"notifications-poll",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.poll",defaultMessage:"Poll results:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","poll"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","poll"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","poll"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","poll"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-status"},void 0,Object(n.a)("span",{id:"notifications-status",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.status",defaultMessage:"New posts:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","status"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","status"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","status"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","status"],onChange:i,label:f}))),Object(n.a)("div",{role:"group","aria-labelledby":"notifications-update"},void 0,Object(n.a)("span",{id:"notifications-update",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.update",defaultMessage:"Edits:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","update"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","update"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","update"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","update"],onChange:i,label:f}))),(this.context.identity.permissions&E.c)===E.c&&Object(n.a)("div",{role:"group","aria-labelledby":"notifications-admin-sign-up"},void 0,Object(n.a)("span",{id:"notifications-status",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.admin.sign_up",defaultMessage:"New sign-ups:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","admin.sign_up"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","admin.sign_up"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","admin.sign_up"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","admin.sign_up"],onChange:i,label:f}))),(this.context.identity.permissions&E.b)===E.b&&Object(n.a)("div",{role:"group","aria-labelledby":"notifications-admin-report"},void 0,Object(n.a)("span",{id:"notifications-status",className:"column-settings__section"},void 0,Object(n.a)(d.a,{id:"notifications.column_settings.admin.report",defaultMessage:"New reports:"})),Object(n.a)("div",{className:"column-settings__pillbar"},void 0,Object(n.a)(G,{disabled:"denied"===c,prefix:"notifications_desktop",settings:t,settingPath:["alerts","admin.report"],onChange:i,label:u}),b&&Object(n.a)(G,{prefix:"notifications_push",settings:e,settingPath:["alerts","admin.report"],onChange:this.onPushChange,label:m}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["shows","admin.report"],onChange:i,label:g}),Object(n.a)(G,{prefix:"notifications",settings:t,settingPath:["sounds","admin.report"],onChange:i,label:f}))))}}J.contextTypes={identity:c.a.object};const Q=Object(r.d)({clearMessage:{id:"notifications.clear_confirmation",defaultMessage:"Are you sure you want to permanently clear all your notifications?"},clearConfirm:{id:"notifications.clear",defaultMessage:"Clear notifications"},permissionDenied:{id:"notifications.permission_denied_alert",defaultMessage:"Desktop notifications can't be enabled, as browser permission has been denied before"}});var V=Object(h.c)(Object(b.connect)((t=>({settings:t.getIn(["settings","notifications"]),pushSettings:t.get("push_notifications"),alertsEnabled:t.getIn(["settings","notifications","alerts"]).includes(!0),browserSupport:t.getIn(["notifications","browserSupport"]),browserPermission:t.getIn(["notifications","browserPermission"])})),((t,e)=>{let{intl:i}=e;return{onChange(e,i){"push"===e[0]?i&&void 0!==window.Notification&&"granted"!==Notification.permission?t(Object(v.E)((n=>{t("granted"===n?Object(B.changeAlerts)(e.slice(1),i):Object(L.e)(void 0,Q.permissionDenied))}))):t(Object(B.changeAlerts)(e.slice(1),i)):"quickFilter"===e[0]?(t(Object(R.c)(["notifications",...e],i)),t(Object(v.G)("all"))):"alerts"===e[0]&&i&&void 0!==window.Notification&&"granted"!==Notification.permission&&i&&void 0!==window.Notification&&"granted"!==Notification.permission?t(Object(v.E)((n=>{t("granted"===n?Object(R.c)(["notifications",...e],i):Object(L.e)(void 0,Q.permissionDenied))}))):t(Object(R.c)(["notifications",...e],i))},onClear(){t(Object(k.b)({modalType:"CONFIRM",modalProps:{message:i.formatMessage(Q.clearMessage),confirm:i.formatMessage(Q.clearConfirm),onConfirm:()=>t(Object(v.u)())}}))},onRequestNotificationPermission(){t(Object(v.E)())}}}))(J));const Y=Object(r.d)({mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Favorites"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Boosts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}});class X extends l.PureComponent{onClick(t){return()=>this.props.selectFilter(t)}render(){const{selectedFilter:t,advancedMode:e,intl:i}=this.props;return e?Object(n.a)("div",{className:"notification__filter-bar"},void 0,Object(n.a)("button",{className:"all"===t?"active":"",onClick:this.onClick("all")},void 0,Object(n.a)(d.a,{id:"notifications.filter.all",defaultMessage:"All"})),Object(n.a)("button",{className:"mention"===t?"active":"",onClick:this.onClick("mention"),title:i.formatMessage(Y.mentions)},void 0,Object(n.a)(C.a,{id:"reply-all",fixedWidth:!0})),Object(n.a)("button",{className:"favourite"===t?"active":"",onClick:this.onClick("favourite"),title:i.formatMessage(Y.favourites)},void 0,Object(n.a)(C.a,{id:"star",fixedWidth:!0})),Object(n.a)("button",{className:"reblog"===t?"active":"",onClick:this.onClick("reblog"),title:i.formatMessage(Y.boosts)},void 0,Object(n.a)(C.a,{id:"retweet",fixedWidth:!0})),Object(n.a)("button",{className:"poll"===t?"active":"",onClick:this.onClick("poll"),title:i.formatMessage(Y.polls)},void 0,Object(n.a)(C.a,{id:"tasks",fixedWidth:!0})),Object(n.a)("button",{className:"status"===t?"active":"",onClick:this.onClick("status"),title:i.formatMessage(Y.statuses)},void 0,Object(n.a)(C.a,{id:"home",fixedWidth:!0})),Object(n.a)("button",{className:"follow"===t?"active":"",onClick:this.onClick("follow"),title:i.formatMessage(Y.follows)},void 0,Object(n.a)(C.a,{id:"user-plus",fixedWidth:!0}))):Object(n.a)("div",{className:"notification__filter-bar"},void 0,Object(n.a)("button",{className:"all"===t?"active":"",onClick:this.onClick("all")},void 0,Object(n.a)(d.a,{id:"notifications.filter.all",defaultMessage:"All"})),Object(n.a)("button",{className:"mention"===t?"active":"",onClick:this.onClick("mention")},void 0,Object(n.a)(d.a,{id:"notifications.filter.mentions",defaultMessage:"Mentions"})))}}var Z=Object(h.c)(X);var tt=Object(b.connect)((t=>({selectedFilter:t.getIn(["settings","notifications","quickFilter","active"]),advancedMode:t.getIn(["settings","notifications","quickFilter","advanced"])})),(t=>({selectFilter(e){t(Object(v.G)(e))}})))(Z),et=i(21),it=i(142),nt=i(16),at=i.n(nt),ot=i(1394),st=i(693),ct=i(146),lt=i(1313),rt=i(1202),dt=i(109),ht=i(6);const pt=Object(r.d)({openReport:{id:"report_notification.open",defaultMessage:"Open report"},other:{id:"report_notification.categories.other",defaultMessage:"Other"},spam:{id:"report_notification.categories.spam",defaultMessage:"Spam"},legal:{id:"report_notification.categories.legal",defaultMessage:"Legal"},violation:{id:"report_notification.categories.violation",defaultMessage:"Rule violation"}});class ut extends y.a{render(){const{intl:t,hidden:e,report:i,account:a}=this.props;return i?e?Object(ht.jsx)(ht.Fragment,{children:i.get("id")}):Object(n.a)("div",{className:"notification__report"},void 0,Object(n.a)("div",{className:"notification__report__avatar"},void 0,Object(n.a)(rt.a,{account:i.get("target_account"),friend:a})),Object(n.a)("div",{className:"notification__report__details"},void 0,Object(n.a)("div",{},void 0,Object(n.a)(dt.a,{timestamp:i.get("created_at"),short:!1})," · ",Object(n.a)(d.a,{id:"report_notification.attached_statuses",defaultMessage:"{count, plural, one {# post} other {# posts}} attached",values:{count:i.get("status_ids").size}}),Object(n.a)("br",{}),Object(n.a)("strong",{},void 0,t.formatMessage(pt[i.get("category")]))),Object(n.a)("div",{className:"notification__report__actions"},void 0,Object(n.a)("a",{href:`/admin/reports/${i.get("id")}`,className:"button",target:"_blank",rel:"noopener noreferrer"},void 0,t.formatMessage(pt.openReport))))):null}}ut.propTypes={account:at.a.map.isRequired,report:at.a.map.isRequired,hidden:c.a.bool,intl:c.a.object.isRequired};var gt=Object(h.c)(ut);class ft extends y.a{constructor(){super(...arguments),this.handleMoveUp=()=>{const{notification:t,onMoveUp:e}=this.props;e(t.get("id"))},this.handleMoveDown=()=>{const{notification:t,onMoveDown:e}=this.props;e(t.get("id"))},this.handleOpen=()=>{this.handleOpenProfile()},this.handleOpenProfile=()=>{const{notification:t}=this.props;this.context.router.history.push(`/@${t.getIn(["account","acct"])}`)},this.handleMention=t=>{t.preventDefault();const{notification:e,onMention:i}=this.props;i(e.get("account"),this.context.router.history)}}getHandlers(){return{moveUp:this.handleMoveUp,moveDown:this.handleMoveDown,open:this.handleOpen,openProfile:this.handleOpenProfile,mention:this.handleMention,reply:this.handleMention}}render(){const{account:t,notification:e,unread:i,report:a}=this.props;if(!a)return null;const o=t.get("display_name_html")||t.get("username"),s=Object(n.a)("bdi",{},void 0,Object(n.a)(ct.a,{className:"notification__display-name",href:t.get("url"),title:t.get("acct"),to:`/@${t.get("acct")}`,dangerouslySetInnerHTML:{__html:o}})),c=a.get("target_account"),l={__html:c.get("display_name_html")},r=Object(n.a)("bdi",{},void 0,Object(n.a)(ct.a,{className:"notification__display-name",href:c.get("url"),title:c.get("acct"),to:`/@${c.get("acct")}`,dangerouslySetInnerHTML:l}));return Object(n.a)(st.HotKeys,{handlers:this.getHandlers()},void 0,Object(n.a)("div",{className:u()("notification notification-admin-report focusable",{unread:i}),tabIndex:0},void 0,Object(n.a)("div",{className:"notification__message"},void 0,Object(n.a)("div",{className:"notification__favourite-icon-wrapper"},void 0,Object(n.a)(C.a,{id:"flag",fixedWidth:!0})),Object(n.a)("span",{title:e.get("created_at")},void 0,Object(n.a)(d.a,{id:"notification.admin.report",defaultMessage:"{name} reported {target}",values:{name:s,target:r}}))),Object(n.a)(gt,{account:t,report:e.get("report"),hidden:this.props.hidden}),Object(n.a)(lt.a,{notification:e})))}}ft.propTypes={hidden:c.a.bool,id:c.a.string.isRequired,account:at.a.map.isRequired,notification:at.a.map.isRequired,unread:c.a.bool,report:at.a.map.isRequired};var bt=Object(b.connect)(((t,e)=>{let{notification:i}=e;const n=Object(it.h)();return{report:i.get("report")?n(t,i.get("report"),i.getIn(["report","target_account","id"])):null}}))(ft),mt=i(20),Ot=i(87),jt=i(111);const vt=Object(r.d)({authorize:{id:"follow_request.authorize",defaultMessage:"Authorize"},reject:{id:"follow_request.reject",defaultMessage:"Reject"}});class _t extends y.a{constructor(){super(...arguments),this.handleMoveUp=()=>{const{notification:t,onMoveUp:e}=this.props;e(t.get("id"))},this.handleMoveDown=()=>{const{notification:t,onMoveDown:e}=this.props;e(t.get("id"))},this.handleOpen=()=>{this.handleOpenProfile()},this.handleOpenProfile=()=>{const{notification:t}=this.props;this.context.router.history.push(`/@${t.getIn(["account","acct"])}`)},this.handleMention=t=>{t.preventDefault();const{notification:e,onMention:i}=this.props;i(e.get("account"),this.context.router.history)}}getHandlers(){return{moveUp:this.handleMoveUp,moveDown:this.handleMoveDown,open:this.handleOpen,openProfile:this.handleOpenProfile,mention:this.handleMention,reply:this.handleMention}}render(){const{intl:t,hidden:e,account:i,onAuthorize:a,onReject:o,notification:s,unread:c}=this.props;if(!i)return Object(n.a)("div",{});if(e)return Object(ht.jsxs)(ht.Fragment,{children:[i.get("display_name"),i.get("username")]});const l=i.get("display_name_html")||i.get("username"),r=Object(n.a)("bdi",{},void 0,Object(n.a)(ct.a,{className:"notification__display-name",href:i.get("url"),title:i.get("acct"),to:`/@${i.get("acct")}`,dangerouslySetInnerHTML:{__html:l}}));return Object(n.a)(st.HotKeys,{handlers:this.getHandlers()},void 0,Object(n.a)("div",{className:u()("notification notification-follow-request focusable",{unread:c}),tabIndex:0},void 0,Object(n.a)("div",{className:"notification__message"},void 0,Object(n.a)("div",{className:"notification__favourite-icon-wrapper"},void 0,Object(n.a)(C.a,{id:"user",fixedWidth:!0})),Object(n.a)(d.a,{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you",values:{name:r}})),Object(n.a)("div",{className:"account"},void 0,Object(n.a)("div",{className:"account__wrapper"},void 0,Object(n.a)(ct.a,{className:"account__display-name",title:i.get("acct"),href:i.get("url"),to:`/@${i.get("acct")}`},i.get("id"),Object(n.a)("div",{className:"account__avatar-wrapper"},void 0,Object(n.a)(Ot.a,{account:i,size:36})),Object(n.a)(jt.a,{account:i})),Object(n.a)("div",{className:"account__relationship"},void 0,Object(n.a)(W.a,{title:t.formatMessage(vt.authorize),icon:"check",onClick:a}),Object(n.a)(W.a,{title:t.formatMessage(vt.reject),icon:"times",onClick:o})))),Object(n.a)(lt.a,{notification:s})))}}_t.propTypes={account:at.a.map.isRequired,onAuthorize:c.a.func.isRequired,onReject:c.a.func.isRequired,intl:c.a.object.isRequired,notification:at.a.map.isRequired,unread:c.a.bool};var Mt=Object(h.c)(_t);var wt=Object(b.connect)(null,((t,e)=>{let{account:i}=e;return{onAuthorize(){t(Object(mt.Q)(i.get("id")))},onReject(){t(Object(mt.ib)(i.get("id")))}}}))(Mt),Ct=i(1040);class Nt extends y.a{constructor(){super(...arguments),this.handleMoveUp=()=>{const{notification:t,onMoveUp:e}=this.props;e(t.get("id"))},this.handleMoveDown=()=>{const{notification:t,onMoveDown:e}=this.props;e(t.get("id"))},this.handleOpen=()=>{this.handleOpenProfile()},this.handleOpenProfile=()=>{const{notification:t}=this.props;this.context.router.history.push(`/@${t.getIn(["account","acct"])}`)},this.handleMention=t=>{t.preventDefault();const{notification:e,onMention:i}=this.props;i(e.get("account"),this.context.router.history)}}getHandlers(){return{moveUp:this.handleMoveUp,moveDown:this.handleMoveDown,open:this.handleOpen,openProfile:this.handleOpenProfile,mention:this.handleMention,reply:this.handleMention}}render(){const{account:t,notification:e,hidden:i,unread:a}=this.props,o=t.get("display_name_html")||t.get("username"),s=Object(n.a)("bdi",{},void 0,Object(n.a)(ct.a,{className:"notification__display-name",href:t.get("url"),title:t.get("acct"),to:`/@${t.get("acct")}`,dangerouslySetInnerHTML:{__html:o}}));return Object(n.a)(st.HotKeys,{handlers:this.getHandlers()},void 0,Object(n.a)("div",{className:u()("notification notification-admin-sign-up focusable",{unread:a}),tabIndex:0},void 0,Object(n.a)("div",{className:"notification__message"},void 0,Object(n.a)("div",{className:"notification__favourite-icon-wrapper"},void 0,Object(n.a)(C.a,{fixedWidth:!0,id:"user-plus"})),Object(n.a)(d.a,{id:"notification.admin.sign_up",defaultMessage:"{name} signed up",values:{name:s}})),Object(n.a)(Ct.a,{hidden:i,id:t.get("id"),withNote:!1}),Object(n.a)(lt.a,{notification:e})))}}Nt.propTypes={hidden:c.a.bool,id:c.a.string.isRequired,account:at.a.map.isRequired,notification:at.a.map.isRequired,unread:c.a.bool};class Pt extends y.a{constructor(){super(...arguments),this.handleMoveUp=()=>{const{notification:t,onMoveUp:e}=this.props;e(t.get("id"))},this.handleMoveDown=()=>{const{notification:t,onMoveDown:e}=this.props;e(t.get("id"))},this.handleOpen=()=>{this.handleOpenProfile()},this.handleOpenProfile=()=>{const{notification:t}=this.props;this.context.router.history.push(`/@${t.getIn(["account","acct"])}`)},this.handleMention=t=>{t.preventDefault();const{notification:e,onMention:i}=this.props;i(e.get("account"),this.context.router.history)}}getHandlers(){return{moveUp:this.handleMoveUp,moveDown:this.handleMoveDown,open:this.handleOpen,openProfile:this.handleOpenProfile,mention:this.handleMention,reply:this.handleMention}}render(){const{account:t,notification:e,hidden:i,unread:a}=this.props,o=t.get("display_name_html")||t.get("username"),s=Object(n.a)("bdi",{},void 0,Object(n.a)(ct.a,{className:"notification__display-name",href:t.get("url"),title:t.get("acct"),to:`/@${t.get("acct")}`,dangerouslySetInnerHTML:{__html:o}}));return Object(n.a)(st.HotKeys,{handlers:this.getHandlers()},void 0,Object(n.a)("div",{className:u()("notification notification-follow focusable",{unread:a}),tabIndex:0},void 0,Object(n.a)("div",{className:"notification__message"},void 0,Object(n.a)("div",{className:"notification__favourite-icon-wrapper"},void 0,Object(n.a)(C.a,{fixedWidth:!0,id:"user-plus"})),Object(n.a)(d.a,{id:"notification.follow",defaultMessage:"{name} followed you",values:{name:s}})),Object(n.a)(Ct.a,{hidden:i,id:t.get("id"),withNote:!1}),Object(n.a)(lt.a,{notification:e})))}}Pt.propTypes={hidden:c.a.bool,id:c.a.string.isRequired,account:at.a.map.isRequired,notification:at.a.map.isRequired,unread:c.a.bool};class xt extends y.a{render(){const{hidden:t,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,getScrollPosition:s,updateScrollBottom:c}=this.props;switch(e.get("type")){case"follow":return Object(n.a)(Pt,{hidden:t,id:e.get("id"),account:e.get("account"),notification:e,onMoveDown:i,onMoveUp:a,onMention:o,unread:this.props.unread});case"follow_request":return Object(n.a)(wt,{hidden:t,id:e.get("id"),account:e.get("account"),notification:e,onMoveDown:i,onMoveUp:a,onMention:o,unread:this.props.unread});case"admin.sign_up":return Object(n.a)(Nt,{hidden:t,id:e.get("id"),account:e.get("account"),notification:e,onMoveDown:i,onMoveUp:a,onMention:o,unread:this.props.unread});case"admin.report":return Object(n.a)(bt,{hidden:t,id:e.get("id"),account:e.get("account"),notification:e,onMoveDown:i,onMoveUp:a,onMention:o,unread:this.props.unread});case"mention":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});case"status":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),account:e.get("account"),prepend:"status",muted:!0,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});case"favourite":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),account:e.get("account"),prepend:"favourite",muted:!0,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});case"reblog":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),account:e.get("account"),prepend:"reblog",muted:!0,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});case"poll":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),account:e.get("account"),prepend:"poll",muted:!0,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});case"update":return Object(n.a)(ot.a,{containerId:e.get("id"),hidden:t,id:e.get("status"),account:e.get("account"),prepend:"update",muted:!0,notification:e,onMoveDown:i,onMoveUp:a,onMention:o,contextType:"notifications",getScrollPosition:s,updateScrollBottom:c,cachedMediaWidth:this.props.cachedMediaWidth,cacheMediaWidth:this.props.cacheMediaWidth,onUnmount:this.props.onUnmount,withDismiss:!0,unread:this.props.unread});default:return null}}}xt.propTypes={notification:at.a.map.isRequired,hidden:c.a.bool,onMoveUp:c.a.func.isRequired,onMoveDown:c.a.func.isRequired,onMention:c.a.func.isRequired,getScrollPosition:c.a.func,updateScrollBottom:c.a.func,cacheMediaWidth:c.a.func,cachedMediaWidth:c.a.number,onUnmount:c.a.func,unread:c.a.bool};var kt=Object(b.connect)((()=>{const t=Object(it.f)();return(e,i)=>({notification:t(e,i.notification,i.accountId),notifCleaning:e.getIn(["notifications","cleaningMode"])})}),(t=>({onMention:(e,i)=>{t(Object(et.vb)(e,i))}})))(xt);const yt=Object(r.d)({title:{id:"column.notifications",defaultMessage:"Notifications"},enterNotifCleaning:{id:"notification_purge.start",defaultMessage:"Enter notification cleaning mode"},markAsRead:{id:"notifications.mark_as_read",defaultMessage:"Mark every notification as read"}}),It=Object(m.a)([t=>t.getIn(["settings","notifications","shows"])],(t=>Object(f.List)(t.filter((t=>!t)).keys()))),Dt=Object(m.a)([t=>t.getIn(["settings","notifications","quickFilter","show"]),t=>t.getIn(["settings","notifications","quickFilter","active"]),It,t=>t.getIn(["notifications","items"])],((t,e,i,n)=>t&&"all"!==e?n.filter((t=>null===t||e===t.get("type"))):n.filterNot((t=>null!==t&&i.includes(t.get("type"))))));class qt extends l.PureComponent{constructor(){super(...arguments),this.state={animatingNCD:!1},this.handleLoadGap=t=>{this.props.dispatch(Object(v.x)({maxId:t}))},this.handleLoadOlder=o()((()=>{const t=this.props.notifications.last();this.props.dispatch(Object(v.x)({maxId:t&&t.get("id")}))}),300,{leading:!0}),this.handleLoadPending=()=>{this.props.dispatch(Object(v.y)())},this.handleScrollToTop=o()((()=>{this.props.dispatch(Object(v.F)(!0))}),100),this.handleScroll=o()((()=>{this.props.dispatch(Object(v.F)(!1))}),100),this.handlePin=()=>{const{columnId:t,dispatch:e}=this.props;e(t?Object(O.h)(t):Object(O.e)("NOTIFICATIONS",{}))},this.handleMove=t=>{const{columnId:e,dispatch:i}=this.props;i(Object(O.g)(e,t))},this.handleHeaderClick=()=>{this.column.scrollTop()},this.setColumnRef=t=>{this.column=t},this.handleMoveUp=t=>{const e=this.props.notifications.findIndex((e=>null!==e&&e.get("id")===t))-1;this._selectChild(e,!0)},this.handleMoveDown=t=>{const e=this.props.notifications.findIndex((e=>null!==e&&e.get("id")===t))+1;this._selectChild(e,!1)},this.handleTransitionEndNCD=()=>{this.setState({animatingNCD:!1})},this.onEnterCleaningMode=()=>{this.setState({animatingNCD:!0}),this.props.onEnterCleaningMode(!this.props.notifCleaningActive)},this.handleMarkAsRead=()=>{this.props.dispatch(Object(v.B)()),this.props.dispatch(Object(j.d)({immediate:!0}))}}componentDidMount(){this.props.dispatch(Object(v.C)())}componentWillUnmount(){this.handleLoadOlder.cancel(),this.handleScrollToTop.cancel(),this.handleScroll.cancel(),this.props.dispatch(Object(v.I)())}_selectChild(t,e){const i=this.column.node,n=i.querySelector(`article:nth-of-type(${t+1}) .focusable`);n&&(e&&i.scrollTop>n.offsetTop?n.scrollIntoView(!0):!e&&i.scrollTop+i.clientHeight<n.offsetTop+n.offsetHeight&&n.scrollIntoView(!1),n.focus())}render(){const{intl:t,notifications:e,isLoading:i,isUnread:a,columnId:o,multiColumn:s,hasMore:c,numPending:l,showFilterBar:r,lastReadId:h,canMarkAsRead:p,needsNotificationPermission:f}=this.props,{notifCleaningActive:b}=this.props,{animatingNCD:m}=this.state,O=!!o,j=Object(n.a)(d.a,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. When other people interact with you, you will see it here."}),{signedIn:v}=this.context.identity;let k=null;const y=v&&r?Object(n.a)(tt,{}):null;let I;k=i&&this.scrollableContent?this.scrollableContent:e.size>0||c?e.map(((t,a)=>null===t?Object(n.a)(N.a,{disabled:i,maxId:a>0?e.getIn([a-1,"id"]):null,onClick:this.handleLoadGap},"gap:"+e.getIn([a+1,"id"])):Object(n.a)(kt,{notification:t,accountId:t.get("account"),onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,unread:"0"!==h&&Object(_.a)(t.get("id"),h)>0},t.get("id")))):null,this.scrollableContent=k,I=v?Object(n.a)(x.a,{scrollKey:`notifications-${o}`,trackScroll:!O,isLoading:i,showLoading:i&&0===e.size,hasMore:c,numPending:l,prepend:f&&Object(n.a)(H,{}),alwaysPrepend:!0,emptyMessage:j,onLoadMore:this.handleLoadOlder,onLoadPending:this.handleLoadPending,onScrollToTop:this.handleScrollToTop,onScroll:this.handleScroll,bindToDocument:!s},void 0,k):Object(n.a)(P.a,{});const D=[];p&&D.push(Object(n.a)("button",{"aria-label":t.formatMessage(yt.markAsRead),title:t.formatMessage(yt.markAsRead),onClick:this.handleMarkAsRead,className:"column-header__button"},"mark-as-read",Object(n.a)(C.a,{id:"check"})));const q=u()("column-header__button",{active:b}),U=u()("ncd column-header__collapsible",{collapsed:!b,animating:m}),R=t.formatMessage(yt.enterNotifCleaning);D.push(Object(n.a)("button",{"aria-label":R,title:R,onClick:this.onEnterCleaningMode,className:q},"notif-cleaning",Object(n.a)(C.a,{id:"eraser"})));const T=Object(n.a)("div",{className:U,onTransitionEnd:this.handleTransitionEndNCD},void 0,Object(n.a)("div",{className:"column-header__collapsible-inner nopad-drawer"},void 0,b||m?Object(n.a)(S,{}):null));return Object(ht.jsxs)(M.a,{bindToDocument:!s,ref:this.setColumnRef,name:"notifications",extraClasses:this.props.notifCleaningActive?"notif-cleaning":null,label:t.formatMessage(yt.title),children:[Object(n.a)(w.a,{icon:"bell",active:a,title:t.formatMessage(yt.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:O,multiColumn:s,localSettings:this.props.localSettings,extraButton:D,appendContent:T},void 0,Object(n.a)(V,{})),y,I,Object(n.a)(g.a,{},void 0,Object(n.a)("title",{},void 0,t.formatMessage(yt.title)),Object(n.a)("meta",{name:"robots",content:"noindex"}))]})}}qt.contextTypes={identity:c.a.object},qt.defaultProps={trackScroll:!0};e.default=Object(b.connect)((t=>({showFilterBar:t.getIn(["settings","notifications","quickFilter","show"]),notifications:Dt(t),localSettings:t.get("local_settings"),isLoading:t.getIn(["notifications","isLoading"],0)>0,isUnread:t.getIn(["notifications","unread"])>0||t.getIn(["notifications","pendingItems"]).size>0,hasMore:t.getIn(["notifications","hasMore"]),numPending:t.getIn(["notifications","pendingItems"],Object(f.List)()).size,notifCleaningActive:t.getIn(["notifications","cleaningMode"]),lastReadId:t.getIn(["settings","notifications","showUnread"])?t.getIn(["notifications","readMarkerId"]):"0",canMarkAsRead:t.getIn(["settings","notifications","showUnread"])&&"0"!==t.getIn(["notifications","readMarkerId"])&&Dt(t).some((e=>null!==e&&Object(_.a)(e.get("id"),t.getIn(["notifications","readMarkerId"]))>0)),needsNotificationPermission:t.getIn(["settings","notifications","alerts"]).includes(!0)&&t.getIn(["notifications","browserSupport"])&&"default"===t.getIn(["notifications","browserPermission"])&&!t.getIn(["settings","notifications","dismissPermissionBanner"])})),(t=>({onEnterCleaningMode(e){t(Object(v.w)(e))},dispatch:t})))(Object(h.c)(qt))}}]);
//# sourceMappingURL=notifications.js.map